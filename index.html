<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- Google Search Console Verification Meta Tag -->
  <meta name="google-site-verification" content="3iM4RS8iUYrjsUirdaXXeHrTv7AHj9sqmrU6jifDWDo" />
  
  <title>Online Image Compressor &amp; Resizer | Free Photo Tools</title>
  <meta 
    name="description" 
    content="Quickly compress and resize your images online for free. Perfect for photos, signatures, and more!"
  >
  <meta 
    name="keywords" 
    content="online image compressor, photo resizer, compress images, resize photos, image size reducer"
  >
  <!-- Optional Google Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" 
    rel="stylesheet"
  >
  <style>
    /* Apply the background image to the entire page */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
      color: #333;
      background: url("background.jpg") no-repeat center center fixed;
      background-size: cover;
    }

    /* Container for the page content */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background-color: rgba(255, 255, 255, 0.85);
      padding: 20px;
      border-radius: 8px;
      margin-top: 20px;
    }

    /* Main heading at 200% font size */
    h1 {
      text-align: center;
      margin-bottom: 20px;
      font-size: 200%;
    }

    .note {
      font-size: 14px;
      text-align: center;
      margin-bottom: 20px;
      color: #555;
    }

    /* Grid layout for the form sections */
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    /* Light grey boxes for form groups */
    .form-group {
      background: #f1f1f1; /* very light grey */
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #555;
    }

    input[type="text"],
    input[type="number"],
    input[type="file"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 14px;
      box-sizing: border-box;
    }

    /* Buttons */
    #resizeBtn, #downloadBtn {
      display: block;
      margin: 10px auto;
      padding: 12px 20px;
      font-size: 16px;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    /* Resize button stays light blue */
    #resizeBtn {
      background: #66a6ff;
    }
    #resizeBtn:hover {
      background: #5595e6;
    }
    #resizeBtn:disabled {
      background: #aaa;
      cursor: not-allowed;
    }

    /* Download button is green */
    #downloadBtn {
      background: #4CAF50;
      display: none; /* hidden initially */
    }
    #downloadBtn:hover {
      background: #43a047;
    }

    /* The text below the main heading (80% font size) */
    .intro-text {
      font-size: 80%;
      margin-bottom: 20px;
    }

    /* FAQ Section at the bottom with extra spacing, 75% font size */
    .faq-section {
      margin-top: 40px;
      font-size: 75%;
    }
    .faq-section h2 {
      margin-bottom: 15px;
    }
    .faq-section h3 {
      margin: 10px 0 5px;
      font-size: 1.1em; 
    }
    .faq-section p {
      margin-bottom: 20px;
      line-height: 1.4;
    }

    /* Link box to the govt-photo-resizer site at the very bottom */
    .other-site-link {
      margin-top: 30px;
      padding: 15px;
      background: #f0fff0;
      border-radius: 6px;
      text-align: center;
      font-size: 0.95rem;
    }
    .other-site-link a {
      color: #008080;
      font-weight: bold;
    }

    /* Responsive adjustments for smaller screens */
    @media (max-width: 600px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Custom Photo Resizer</h1>

    <!-- Intro text at 80% font size -->
    <div class="intro-text">
      <h2>Why Use Our Online Image Compressor?</h2>
      <p>
        Our online image compressor and photo resizer makes it easy 
        to reduce file sizes without losing quality. Whether you need 
        to upload a signature or optimize a product photo, this free 
        tool saves you time and bandwidth.
      </p>
    </div>

    <p class="note">
      Provide either the width &amp; height range OR the exact dimensions (in inches @ dpi).<br>
      <strong>Do not fill both.</strong>
    </p>

    <div class="grid-container">
      <!-- Column 1: Image Upload -->
      <div class="form-group">
        <label for="imageUpload">Upload Image</label>
        <input type="file" id="imageUpload" accept="image/*" />

        <!-- Drag & Drop Box -->
        <div 
          id="dropZone"
          style="
            margin-top: 10px;
            border: 2px dashed #aaa; 
            border-radius: 6px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            background-color: #f9f9f9;
          "
        >
          <p style="margin:0;">Drag &amp; Drop Your Image Here (or Click)</p>
        </div>
      </div>

      <!-- Column 2: File Size Limits -->
      <div class="form-group">
        <label for="minSize">Min File Size (KB)</label>
        <input type="number" id="minSize" placeholder="e.g., 50" />
        <label for="maxSize">Max File Size (KB)</label>
        <input type="number" id="maxSize" placeholder="e.g., 300" />
      </div>
      <!-- Column 3: Width Range -->
      <div class="form-group">
        <label for="minWidth">Min Width (px)</label>
        <input type="number" id="minWidth" placeholder="e.g., 300" />
        <label for="maxWidth">Max Width (px)</label>
        <input type="number" id="maxWidth" placeholder="e.g., 600" />
      </div>
      <!-- Column 4: Height Range -->
      <div class="form-group">
        <label for="minHeight">Min Height (px)</label>
        <input type="number" id="minHeight" placeholder="e.g., 300" />
        <label for="maxHeight">Max Height (px)</label>
        <input type="number" id="maxHeight" placeholder="e.g., 600" />
      </div>
      <!-- Column 5: Exact Dimensions (Optional) -->
      <div class="form-group">
        <label for="dimensions">Exact Dimensions (inches @ dpi)</label>
        <input type="text" id="dimensions" placeholder="e.g., 2x2 @300" />
      </div>
    </div>
    
    <!-- Resize Button -->
    <button id="resizeBtn" disabled>Resize</button>
    <!-- Download Button (appears after resize) -->
    <button id="downloadBtn">Download Resized Image</button>
    <!-- Hidden Canvas to Process the Image -->
    <canvas id="canvas" style="display: none;"></canvas>

    <!-- New italicized note above the FAQ -->
    <p style="font-style: italic; margin-top: 20px;">
      *Note: If you want to resize an image to a specific dimension (for example, 300Ã—400),
      simply enter 300 in both the Min Width and Max Width fields, and 400 in both the
      Min Height and Max Height fields.
    </p>

    <!-- FAQ Section at 75% font size -->
    <div class="faq-section">
      <h2>Frequently Asked Questions (FAQ)</h2>

      <h3>Will compressing my image reduce its quality?</h3>
      <p>
        Our <strong>online image compressor</strong> does its best to maintain 
        high-quality results. You can resize and compress without losing too much detail.
      </p>

      <h3>How do I resize an image without losing clarity?</h3>
      <p>
        Use our <strong>photo resizer</strong> feature to adjust width and height 
        while preserving aspect ratio. This helps maintain image clarity.
      </p>
    </div>

    <!-- Link box at the bottom, pointing to govt-photo-resizer -->
    <div class="other-site-link">
      <p>
        Applying for government exams?
        <a href="https://roseneinstein.github.io/govt-photo-resizer/" target="_blank">
          Check out our Govt Exams Photo Resizer
        </a>
        to see upcoming exams and resize your photo/signature <strong>automatically!</strong>
      </p>
    </div>
  </div>

  <script>
    // Get references to our form elements.
    const imageUpload = document.getElementById('imageUpload');
    const minSize = document.getElementById('minSize');
    const maxSize = document.getElementById('maxSize');
    const minWidth = document.getElementById('minWidth');
    const maxWidth = document.getElementById('maxWidth');
    const minHeight = document.getElementById('minHeight');
    const maxHeight = document.getElementById('maxHeight');
    const dimensions = document.getElementById('dimensions');
    const resizeBtn = document.getElementById('resizeBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const canvas = document.getElementById('canvas');

    let resizedImageDataURL = '';

    // Hide the download button and clear the last image whenever inputs change
    function resetDownload() {
      downloadBtn.style.display = 'none';
      resizedImageDataURL = '';
    }

    // Validate that required fields are filled.
    function validateInputs() {
      if (!imageUpload.files || imageUpload.files.length === 0) return false;
      if (!minSize.value || !maxSize.value) return false;
      // Check if either width/height range is provided or exact dimensions.
      const rangeProvided = minWidth.value && maxWidth.value && minHeight.value && maxHeight.value;
      const exactProvided = dimensions.value;
      if (!rangeProvided && !exactProvided) return false;
      return true;
    }

    // Enable or disable the Resize button based on input validation.
    function updateResizeButton() {
      resizeBtn.disabled = !validateInputs();
    }

    // Whenever the user changes any input, reset the download link and update the button
    [imageUpload, minSize, maxSize, minWidth, maxWidth, minHeight, maxHeight, dimensions].forEach(input => {
      input.addEventListener('input', () => {
        resetDownload();
        updateResizeButton();
      });
    });

    // Function to estimate the size (in KB) of a Data URL.
    function dataURLSizeKB(dataURL) {
      const base64Str = dataURL.split(',')[1];
      const sizeInBytes = Math.floor((base64Str.length * 3) / 4);
      return sizeInBytes / 1024;
    }

    // Adjust the JPEG quality until the file size is within the user-specified limits.
    function getDataURLWithSizeConstraints(minKB, maxKB, callback) {
      let quality = 0.9; // Start with a high quality.
      const step = 0.05; // Quality adjustment step.
      let dataURL = canvas.toDataURL('image/jpeg', quality);
      let sizeKB = dataURLSizeKB(dataURL);

      // Lower quality if the file is too high.
      while (sizeKB > maxKB && quality > 0.1) {
        quality -= step;
        dataURL = canvas.toDataURL('image/jpeg', quality);
        sizeKB = dataURLSizeKB(dataURL);
      }

      // Increase quality if the file is too low.
      while (sizeKB < minKB && quality < 1.0) {
        quality += step;
        if (quality > 1.0) quality = 1.0;
        dataURL = canvas.toDataURL('image/jpeg', quality);
        sizeKB = dataURLSizeKB(dataURL);
        if (quality === 1.0) break;
      }
      callback(dataURL, quality, sizeKB);
    }

    // When the user clicks the Resize button.
    resizeBtn.addEventListener('click', function () {
      // Check if both the range and the exact dimension fields are filled.
      const rangeProvided = minWidth.value && maxWidth.value && minHeight.value && maxHeight.value;
      const exactProvided = dimensions.value;
      if (rangeProvided && exactProvided) {
        alert("Please provide either the width & height ranges or the exact dimensions (in inches @ dpi), not both.");
        return;
      }
      if (!validateInputs()) {
        alert('Please fill in all required fields.');
        return;
      }
      const file = imageUpload.files[0];
      const reader = new FileReader();
      reader.onload = function (event) {
        const img = new Image();
        img.onload = function () {
          let newWidth, newHeight;
          if (exactProvided) {
            // Parse the format "widthxheight @dpi" (e.g., "2x2 @300")
            const parts = dimensions.value.split('@');
            if (parts.length === 2) {
              const dims = parts[0].trim().split('x');
              if (dims.length === 2) {
                const dpi = parseInt(parts[1].trim());
                const inchesWidth = parseFloat(dims[0]);
                const inchesHeight = parseFloat(dims[1]);
                newWidth = Math.round(inchesWidth * dpi);
                newHeight = Math.round(inchesHeight * dpi);
              }
            }
          } else {
            newWidth = parseInt(minWidth.value);
            newHeight = parseInt(minHeight.value);
          }
          // Resize the image using a hidden canvas.
          canvas.width = newWidth;
          canvas.height = newHeight;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0, newWidth, newHeight);

          // Adjust JPEG quality to meet file size constraints.
          getDataURLWithSizeConstraints(parseInt(minSize.value), parseInt(maxSize.value), function(dataURL, qualityUsed, finalSizeKB) {
            resizedImageDataURL = dataURL;
            downloadBtn.style.display = 'block'; // Show green Download button
            alert("Resize successful! Your image meets the size criteria. Final file size: " 
              + finalSizeKB.toFixed(1) 
              + " KB. Click the Download button to save your image."
            );
          });
        };
        img.src = event.target.result;
      };
      reader.readAsDataURL(file);
    });

    // When the user clicks the Download button.
    downloadBtn.addEventListener('click', function () {
      if (!resizedImageDataURL) return;
      const link = document.createElement('a');
      link.href = resizedImageDataURL;
      link.download = 'resized-image.jpg';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });

    /* --- DRAG & DROP LOGIC --- */
    const dropZone = document.getElementById('dropZone');

    // Prevent default drag behaviors
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      dropZone.addEventListener(eventName, e => {
        e.preventDefault();
        e.stopPropagation();
      }, false);
    });

    // Highlight drop zone on dragover
    dropZone.addEventListener('dragover', () => {
      dropZone.style.borderColor = '#66a6ff';
    });

    // Unhighlight on dragleave or drop
    dropZone.addEventListener('dragleave', () => {
      dropZone.style.borderColor = '#aaa';
    });
    dropZone.addEventListener('drop', () => {
      dropZone.style.borderColor = '#aaa';
    });

    // Handle dropped files
    dropZone.addEventListener('drop', e => {
      const droppedFiles = e.dataTransfer.files;
      if (droppedFiles && droppedFiles.length > 0) {
        // Assign dropped files to the existing input
        imageUpload.files = droppedFiles;
        // Trigger the same 'input' event logic
        imageUpload.dispatchEvent(new Event('input'));
      }
    });

    // Optional: let user click the drop zone to open file dialog
    dropZone.addEventListener('click', () => {
      imageUpload.click();
    });
  </script>
</body>
</html>
